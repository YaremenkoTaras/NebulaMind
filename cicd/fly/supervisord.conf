[supervisord]
nodaemon=true
logfile=/app/logs/supervisord.log
pidfile=/var/run/supervisord.pid
loglevel=info

[program:trading-core]
command=java -jar /app/trading-core.jar --server.port=8081
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/trading-core.log
stderr_logfile=/app/logs/trading-core-error.log
environment=SPRING_PROFILES_ACTIVE="%(ENV_SPRING_PROFILES_ACTIVE)s",LOG_DIR="%(ENV_LOG_DIR)s"
startsecs=10
priority=100

[program:agent-builder]
command=java -jar /app/agent-builder.jar --server.port=8082
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/agent-builder.log
stderr_logfile=/app/logs/agent-builder-error.log
environment=SPRING_PROFILES_ACTIVE="%(ENV_SPRING_PROFILES_ACTIVE)s",LOG_DIR="%(ENV_LOG_DIR)s",CORE_API_URL="http://localhost:8081"
startsecs=15
priority=200

[program:caddy]
command=caddy run --config /etc/caddy/Caddyfile
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/caddy.log
stderr_logfile=/app/logs/caddy-error.log
startsecs=5
priority=300

